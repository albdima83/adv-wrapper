/* ESM | Version: 0.0.3 | Commit: d272c9b */
var C="0.0.3";var E;(i=>{let a;(o=>(o.ALWAYS="always",o.ON_MASTER_AD="on_master_ad"))(a=i.CompanionBackfillMode||={});let e;(d=>(d[d.DISABLED=0]="DISABLED",d[d.ENABLED=1]="ENABLED",d[d.INSECURE=2]="INSECURE"))(e=i.VpaidMode||={});class t{getCompanionBackfill(){return"always"}getDisableCustomPlaybackForIOS10Plus(){return!0}getFeatureFlags(){return{}}getLocale(){return""}getNumRedirects(){return-1}getPlayerType(){return"lib"}getPlayerVersion(){return"1.0.0"}getPpid(){return""}isCookiesEnabled(){return!1}setAutoPlayAdBreaks(r){}setCompanionBackfill(){}setCookiesEnabled(r){}setDisableCustomPlaybackForIOS10Plus(r){}setFeatureFlags(r){}setLocale(r){}setNumRedirects(r){}setPlayerType(r){}setPlayerVersion(r){}setPpid(r){}setSessionId(r){}setVpaidAllowed(r){}setVpaidMode(r){}}i.ImaSdkSettings=t})(E||={});var B=new E.ImaSdkSettings;var T=class{adId;adPodInfo;adSystem;advertiserName;apiFramework;companionAds;creativeAdId;creativeId;dealId;description;duration;height;mediaUrl;minSuggestedDuration;skipTimeOffset;surveyUrl;title;traffickingParameters;traffickingParametersString;uiElements;universalAdIdRegistry;universalAdIdValue;universalAdIds;vastMediaBitrate;vastMediaHeight;vastMediaWidth;width;wrapperAdIds;wrapperAdSystems;wrapperCreativeIds;linear;constructor(e,t,i,s){this.adId=e.id||"undefined",this.adPodInfo=s,this.adSystem=e.adSystem||"",this.advertiserName=e.advertiser||"",this.apiFramework=t.apiFramework||"",this.companionAds=[],this.creativeAdId=t.adId||"",this.creativeId=t.id||"",this.dealId="",this.description=e.description||"",this.duration=t.duration||0,this.height=0,this.mediaUrl=null,this.minSuggestedDuration=0,this.skipTimeOffset=t.skipDelay||-1,this.surveyUrl=null,this.title=e.adTitle||"",this.traffickingParameters={},this.traffickingParametersString="",this.uiElements=[],this.universalAdIdRegistry="",this.universalAdIdValue="",this.universalAdIds=[],this.vastMediaBitrate=0,this.vastMediaHeight=0,this.vastMediaWidth=0,this.width=0,this.wrapperAdIds=[],this.wrapperAdSystems=[],this.wrapperCreativeIds=[],this.linear=t.type==="linear"}getAdId(){return this.adId}getAdPodInfo(){return this.adPodInfo}getAdSystem(){return this.adSystem}getAdvertiserName(){return this.advertiserName}getApiFramework(){return this.apiFramework}getCompanionAds(e,t,i){return this.companionAds}getCreativeAdId(){return this.creativeAdId}getCreativeId(){return this.creativeId}getDealId(){return this.dealId}getDescription(){return this.description}getDuration(){return this.duration}getHeight(){return this.height}getMediaUrl(){return this.mediaUrl}getMinSuggestedDuration(){return this.minSuggestedDuration}getSkipTimeOffset(){return this.skipTimeOffset}getSurveyUrl(){return this.surveyUrl}getTitle(){return this.title}getTraffickingParameters(){return this.traffickingParameters}getTraffickingParametersString(){return this.traffickingParametersString}getUiElements(){return this.uiElements}getUniversalAdIdRegistry(){throw new Error("Method not implemented.")}getUniversalAdIdValue(){return this.universalAdIdValue}getUniversalAdIds(){return this.universalAdIds}getVastMediaBitrate(){return this.vastMediaBitrate}getVastMediaHeight(){return this.vastMediaHeight}getVastMediaWidth(){return this.vastMediaWidth}getWidth(){return this.width}getWrapperAdIds(){return this.wrapperAdIds}getWrapperAdSystems(){return this.wrapperAdSystems}getWrapperCreativeIds(){return this.wrapperCreativeIds}isLinear(){return this.linear}};var M=["debug","info","warn","error","fatal","trace"],H={debug:console.debug||console.log,info:console.info||console.log,warn:console.warn||console.log,error:console.error||console.log,fatal:console.error||console.log,trace:console.trace||console.log},D=class{enable;level;constructor(e){this.enable=e.enable||!1,this.level=e.level||"info"}debug(e,t,...i){this.log("debug",e,t,...i)}info(e,t,...i){this.log("info",e,t,...i)}warn(e,t,...i){this.log("warn",e,t,...i)}error(e,t,...i){this.log("error",e,t,...i)}setLogLevel(e){this.level=e}setEnable(e){this.enable=e}log(e,t,i,...s){if(this.enable&&M.indexOf(e)>=M.indexOf(this.level)){let r=new Date().toISOString();(H[e]??console.log)(`[${t}][${e}]`,i,...s)}}},j=new D({enable:!1,level:"error"}),c=j;var P="ima:AdDisplayContainer",k=class{adContainer;videoElement;contentElement;adsContainerElement;adsSpinnerElement;videoAdsElement;constructor(e,t,i){this.adContainer=e,this.videoElement=t,this.contentElement=i}initialize(){c.debug(P,"initialize"),this.adsContainerElement||(this.adsContainerElement=this.createAdsContainer()),this.videoAdsElement||(this.videoAdsElement=this.createAdsVideoElement()),this.adsSpinnerElement||(this.adsSpinnerElement=this.createAdsSpinner())}destroy(){c.debug(P,"destroy"),this.videoAdsElement?.remove(),this.adsSpinnerElement?.remove(),this.adsContainerElement?.remove(),this.videoAdsElement=void 0}addEventListener(e,t,i){}removeEventListener(e,t,i){}dispatchEvent(e){return!0}getVideoAdsElement(){return this.videoAdsElement||this.videoElement}show(){let e=this.adsContainerElement;e&&(e.style.display="block",e.style.visibility="visible",e.style.opacity="1")}hide(){let e=this.adsContainerElement;e&&(e.style.display="none",e.style.visibility="hidden",e.style.opacity="0")}showLoader(){let e=this.adsSpinnerElement;e&&(e.style.visibility="block")}hideLoader(){let e=this.adsSpinnerElement;e&&(e.style.visibility="none")}hideAdVideoElement(){let e=this.videoAdsElement;e&&(e.style.visibility="hidden",e.style.opacity="0")}showAdVideoElement(){let e=this.videoAdsElement;e&&(e.style.display="block",e.style.visibility="visible",e.style.opacity="1")}clearAdVideoElement(){let e=this.videoAdsElement;e&&(e.style.display="none",e.autoplay=!1,e.pause(),e.src="",e.load())}createAdsContainer(){let e=this.adContainer;if(!e)return;let t=document.getElementById("adm-adv-container")||document.createElement("div");return t.id="adm-adv-container",t.style.position="absolute",t.style.inset="0",t.style.top="0",t.style.left="0",t.style.right="0",t.style.bottom="0",t.style.background="rgb(0,0,0)",t.style.display="none",e.appendChild(t),t}createAdsSpinner(){let e=this.adsContainerElement;if(!e)return;let t=document.getElementById("adm-adv-spinner")||document.createElement("div");t.id="adm-adv-spinner",t.style.position="absolute",t.style.top="50%",t.style.left="50%",t.style.transform="translate(-50%, -50%)",t.style.width="40px",t.style.height="40px",t.style.border="5px solid #ccc",t.style.borderTop="5px solid #333",t.style.borderRadius="50%",t.style.zIndex="10",t.style.animation="adm-spinner-animation 1s linear infinite",t.style.display="none";let i=document.createElement("style");return i.textContent=`
      @keyframes adm-spinner-animation {
        0% { transform: translate(-50%, -50%) rotate(0deg); }
        100% { transform: translate(-50%, -50%) rotate(360deg); }
      }
    `,globalThis&&globalThis.document&&document.head.appendChild(i),e.appendChild(t),t}createAdsVideoElement(){let e=this.adsContainerElement;if(!e)return;let t=document.getElementById("adm-video-ads")||document.createElement("video");return t.id="adm-video-ads",t.style.position="absolute",t.style.inset="0",t.style.top="0",t.style.left="0",t.style.right="0",t.style.bottom="0",t.style.width="100%",t.style.height="100%",t.style.objectFit="cover",t.style.background="black",t.controls=!1,t.playsInline=!1,t.setAttribute("disablePictureInPicture",""),t.setAttribute("disableRemotePlayback",""),t.setAttribute("playsinline","false"),t.setAttribute("webkit-playsinline","false"),t.setAttribute("x-webkit-airplay","allow"),t.setAttribute("object","fit"),t.removeAttribute("controls"),e.appendChild(t),t}};var S;(i=>{let a;(n=>(n[n.VAST_MALFORMED_RESPONSE=100]="VAST_MALFORMED_RESPONSE",n[n.VAST_SCHEMA_VALIDATION_ERROR=101]="VAST_SCHEMA_VALIDATION_ERROR",n[n.VAST_UNSUPPORTED_VERSION=102]="VAST_UNSUPPORTED_VERSION",n[n.VAST_TRAFFICKING_ERROR=200]="VAST_TRAFFICKING_ERROR",n[n.VAST_UNEXPECTED_LINEARITY=201]="VAST_UNEXPECTED_LINEARITY",n[n.VAST_UNEXPECTED_DURATION_ERROR=202]="VAST_UNEXPECTED_DURATION_ERROR",n[n.VAST_WRAPPER_ERROR=300]="VAST_WRAPPER_ERROR",n[n.VAST_LOAD_TIMEOUT=301]="VAST_LOAD_TIMEOUT",n[n.VAST_TOO_MANY_REDIRECTS=302]="VAST_TOO_MANY_REDIRECTS",n[n.VAST_NO_ADS_AFTER_WRAPPER=303]="VAST_NO_ADS_AFTER_WRAPPER",n[n.VIDEO_PLAY_ERROR=400]="VIDEO_PLAY_ERROR",n[n.VAST_MEDIA_LOAD_TIMEOUT=402]="VAST_MEDIA_LOAD_TIMEOUT",n[n.VAST_LINEAR_ASSET_MISMATCH=403]="VAST_LINEAR_ASSET_MISMATCH",n[n.VAST_PROBLEM_DISPLAYING_MEDIA_FILE=405]="VAST_PROBLEM_DISPLAYING_MEDIA_FILE",n[n.OVERLAY_AD_PLAYING_FAILED=500]="OVERLAY_AD_PLAYING_FAILED",n[n.NONLINEAR_DIMENSIONS_ERROR=501]="NONLINEAR_DIMENSIONS_ERROR",n[n.OVERLAY_AD_LOADING_FAILED=502]="OVERLAY_AD_LOADING_FAILED",n[n.VAST_NONLINEAR_ASSET_MISMATCH=503]="VAST_NONLINEAR_ASSET_MISMATCH",n[n.COMPANION_REQUIRED_ERROR=602]="COMPANION_REQUIRED_ERROR",n[n.COMPANION_AD_LOADING_FAILED=603]="COMPANION_AD_LOADING_FAILED",n[n.UNKNOWN_ERROR=900]="UNKNOWN_ERROR",n[n.VPAID_ERROR=901]="VPAID_ERROR",n[n.FAILED_TO_REQUEST_ADS=1005]="FAILED_TO_REQUEST_ADS",n[n.VAST_ASSET_NOT_FOUND=1007]="VAST_ASSET_NOT_FOUND",n[n.VAST_EMPTY_RESPONSE=1009]="VAST_EMPTY_RESPONSE",n[n.UNKNOWN_AD_RESPONSE=1010]="UNKNOWN_AD_RESPONSE",n[n.ADS_REQUEST_NETWORK_ERROR=1012]="ADS_REQUEST_NETWORK_ERROR",n[n.INVALID_AD_TAG=1013]="INVALID_AD_TAG",n[n.PROTECTED_AUDIENCE_API_ERROR=1014]="PROTECTED_AUDIENCE_API_ERROR",n[n.STREAM_INITIALIZATION_FAILED=1020]="STREAM_INITIALIZATION_FAILED",n[n.ASSET_FALLBACK_FAILED=1021]="ASSET_FALLBACK_FAILED",n[n.UNSUPPORTED_URL=1022]="UNSUPPORTED_URL",n[n.INVALID_ARGUMENTS=1101]="INVALID_ARGUMENTS",n[n.NATIVE_MESSAGE_ERROR=1204]="NATIVE_MESSAGE_ERROR",n[n.AUTOPLAY_DISALLOWED=1205]="AUTOPLAY_DISALLOWED",n[n.CONSENT_MANAGEMENT_PROVIDER_NOT_READY=1300]="CONSENT_MANAGEMENT_PROVIDER_NOT_READY"))(a=i.ErrorCode||={});let e;(o=>(o.AD_LOAD="adLoadError",o.AD_PLAY="adPlayError"))(e||={});class t{name;code;message;stack;cause;constructor(r,o){this.name="AdError",this.message=o,this.code=r}getErrorCode(){return this.code}getInnerError(){return new Error(this.message)}getMessage(){throw this.message}getType(){throw""}getVastErrorCode(){throw this.code}}i.AdError=t})(S||={});var y;(t=>{let a;(s=>s.AD_ERROR="adError")(a=t.Type||={});class e{target;currentTarget;type="adError";adError;userRequestContext;constructor(s,r){this.adError=s,this.userRequestContext=r}getError(){return this.adError||null}getUserRequestContext(){return this.userRequestContext||null}preventDefault(){}stopPropagation(){}}t.AdErrorEvent=e})(y||={});var h;(t=>{let a;(l=>(l.AD_BREAK_FETCH_ERROR="adBreakFetchError",l.AD_BREAK_READY="adBreakReady",l.AD_BUFFERING="adBuffering",l.AD_CAN_PLAY="adCanPlay",l.AD_METADATA="adMetadata",l.AD_PROGRESS="adProgress",l.ALL_ADS_COMPLETED="allAdsCompleted",l.CLICK="click",l.COMPLETE="complete",l.CONTENT_PAUSE_REQUESTED="contentPauseRequested",l.CONTENT_RESUME_REQUESTED="contentResumeRequested",l.DURATION_CHANGE="durationChange",l.FIRST_QUARTILE="firstquartile",l.IMPRESSION="impression",l.INTERACTION="interaction",l.LINEAR_CHANGED="linearChanged",l.LOADED="loaded",l.LOG="log",l.MIDPOINT="midpoint",l.PAUSED="pause",l.RESUMED="resume",l.SKIPPABLE_STATE_CHANGED="skippableStateChanged",l.SKIPPED="skipped",l.STARTED="start",l.THIRD_QUARTILE="thirdquartile",l.USER_CLOSE="userClose",l.VIDEO_CLICKED="videoClicked",l.VIDEO_ICON_CLICKED="videoIconClicked",l.VOLUME_CHANGED="volumeChanged",l.VOLUME_MUTED="volumeMuted"))(a=t.Type||={});class e{currentTarget;target;type="loaded";ad=void 0;adData=null;constructor(s,r){this.type=s,this.ad=r}getAd(){return this.ad||null}getAdData(){return this.adData}preventDefault(){}stopPropagation(){}}t.AdEvent=e})(h||={});var L=class{adPosition;isBumper;maxDuration;podIndex;timeOffset;totalAds;constructor(e,t,i,s,r,o){this.adPosition=e,this.isBumper=t,this.maxDuration=i,this.podIndex=s,this.timeOffset=r,this.totalAds=o}getAdPosition(){return this.adPosition}getIsBumper(){return this.isBumper}getMaxDuration(){return this.maxDuration}getPodIndex(){return this.podIndex}getTimeOffset(){return this.timeOffset}getTotalAds(){return this.totalAds}};var f=class{listeners={};addEventListener(e,t,i=!1,s=null){if(t===null)throw new Error("Handler cannot be null");this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push({handler:t instanceof Function?t:t?.handleEvent,scope:s,capture:i})}emit(e,...t){this.listeners[e]&&this.listeners[e].forEach(i=>{i.handler.apply(i.scope,t)})}removeEventListener(e,t,i=!1){this.listeners[e]&&(this.listeners[e]=this.listeners[e].filter(s=>s.handler!==(t instanceof Function?t:t?.handleEvent)||s.capture!==i))}clearEventListeners(e){this.listeners[e]&&delete this.listeners[e]}clearAllEventListeners(){this.listeners={}}};import{VASTClient as W,VASTTracker as G}from"@dailymotion/vast-client";import{XMLParser as Q}from"fast-xml-parser";var q=/^\d{2}:\d{2}(?::\d{2}(?:\.\d{3})?)?$/;function I(a){if(a=="start"||a=="end")return 0;if(q.test(a)){let[e="00",t="00",i="00"]=a.split(":"),s="00",r="000";return i.includes(".")?[s,r]=i.split("."):s=i,(parseInt(e,10)*3600+parseInt(t,10)*60+parseInt(s,10))*1e3+parseInt(r,10)}return parseFloat(a)}function O(a){return new Promise((e,t)=>{a.preload="auto",a.load();let i=()=>{a.removeEventListener("canplay",i),e()},s=()=>{a.removeEventListener("error",s),t(new Error("Video failed to load"))};a.addEventListener("canplaythrough",i),a.addEventListener("error",s)})}var x=["play","pause","ended","waiting","stalled","canplay","playing","seeking","seeked","timeupdate","durationchange","loadedmetadata","suspend","abort"],K=500,g="ima:AdsManager",R=class{adsRequest;adDisplayContainer;adsRenderingSettings=void 0;vastTracker;content=void 0;eventEmitter;cuePoints;cueMapPoints;started=!1;nextAds=[];totalAds=0;totalTimeAds=0;currentPodIndex=0;canBeAdSkippable=!1;currentAdBreak=void 0;currentAdVast=void 0;currentAd=void 0;currentCreative=void 0;queueCreatives=[];processingAdv=!1;timerUpdateContentTime=void 0;adRemainingTime=-1;adDuration=-1;quartilesFired={start:!1,firstQuartile:!1,midpoint:!1,thirdQuartile:!1,complete:!1};constructor(e,t){this.adsRequest=e,this.adDisplayContainer=t,this.eventEmitter=new f,this.content=void 0,this.cuePoints=[],this.cueMapPoints={},this.adsRenderingSettings=void 0,this.started=!1,this.processingAdv=!1,this.canBeAdSkippable=!1,this.adRemainingTime=-1,this.adDuration=-1,this.fetchVmap=this.fetchVmap.bind(this),this.attachContentMediaEventListeners=this.attachContentMediaEventListeners.bind(this),this.detachContentMediaEventListeners=this.detachContentMediaEventListeners.bind(this),this.handleContentTimeUpdate=this.handleContentTimeUpdate.bind(this),this.adsVideoEventsListener=this.adsVideoEventsListener.bind(this),this.adsVideoErrorListener=this.adsVideoErrorListener.bind(this)}collapse(){throw new Error("Method not implemented.")}configureAdsManager(e,t){this.content=e,this.adsRenderingSettings=t||void 0}destroy(){this.detachContentMediaEventListeners(),this.eventEmitter.clearAllEventListeners(),this.content=void 0,this.adsRenderingSettings=void 0}discardAdBreak(){}expand(){}focus(){}getAdSkippableState(){return this.canBeAdSkippable}getCuePoints(){return this.cuePoints}getRemainingTime(){return this.currentCreative?this.adRemainingTime:-1}getVolume(){return this.adDisplayContainer.getVideoAdsElement().volume}init(e,t,i,s){}isCustomClickTrackingUsed(){throw new Error("Method not implemented.")}isCustomPlaybackUsed(){throw new Error("Method not implemented.")}pause(){throw new Error("Method not implemented.")}resize(e,t,i){throw new Error("Method not implemented.")}resume(){throw new Error("Method not implemented.")}setVolume(e){let t=this.adDisplayContainer.getVideoAdsElement();t&&(t.volume=e)}skip(){let e=this.adDisplayContainer.getVideoAdsElement(),t=this.currentCreative?.skipDelay||0;if(!(!e||t<=0||this.adRemainingTime>t&&this.adRemainingTime<this.adDuration))try{e.pause()}finally{c.debug(g,"video user skipped"),this.vastTracker?.skip(),this.dispatchAdsEvent(h.Type.SKIPPED),this.playCreativities()}}start(){this.started||(this.started=!0,this.fetchVastAds(0),this.attachContentMediaEventListeners())}stop(){this.started=!1}updateAdsRenderingSettings(e){throw new Error("Method not implemented.")}addEventListener(e,t,i,s){this.eventEmitter.addEventListener(e,t,i,s)}removeEventListener(e,t,i,s){this.eventEmitter.removeEventListener(e,t,i)}dispatchEvent(e){return!0}fetchVmap(){let e=this.adsRequest.adTagUrl;return fetch(e).then(t=>t.text()).then(t=>{let r=new Q({ignoreAttributes:!1,attributeNamePrefix:"@_",textNodeName:"#text"}).parse(t)?.["vmap:VMAP"]["vmap:AdBreak"];if(!r)return this;if(Array.isArray(r))r.forEach(o=>{let d=o["@_timeOffset"];if(d){let m=I(d);if(!isNaN(m)&&this.isValidAdBreak(o)){c.debug(g,`vmap adBreak timeOffset [${d}]:`,m),this.cuePoints.includes(m)||this.cuePoints.push(m);let v=this.cueMapPoints[m]||[];v.push(o),this.cueMapPoints[m]=v}}});else{let o=r["@_timeOffset"];if(o){let d=I(o);!isNaN(d)&&this.isValidAdBreak(r)&&(this.cuePoints.push(d),this.cueMapPoints[d]=[r])}}return this.adDisplayContainer.initialize(),this}).catch(t=>Promise.reject(t))}isValidContentObject(e){return!!e&&(e instanceof HTMLVideoElement||"currentTime"in e)}allAdsCompleted(){this.removeVideoListeners(),this.dispatchAdsEvent(h.Type.ALL_ADS_COMPLETED),this.nextAds=[],this.queueCreatives=[],this.vastTracker=void 0,this.currentAdVast=void 0,this.currentAdBreak=void 0,this.currentAd=void 0,this.currentCreative=void 0,this.adRemainingTime=-1,this.canBeAdSkippable=!1,this.adDisplayContainer?.hideAdVideoElement(),this.adDisplayContainer?.clearAdVideoElement(),this.adDisplayContainer?.hide(),this.processingAdv=!1,this.dispatchAdsEvent(h.Type.CONTENT_RESUME_REQUESTED)}playCreativities(){this.processingAdv=!0;let e=!!this.currentAd;if(this.currentCreative=void 0,this.currentAdVast&&this.queueCreatives.length>0){let i=this.queueCreatives.shift();if(!i)return this.playCreativities();let s=i.mediaFiles;if(s&&s.length>0)for(let r of s){let o=r.mimeType;if(o&&o.startsWith("video/mp4")&&r.fileURL){this.currentCreative=i,this.vastTracker=new G(null,this.currentAdVast,this.currentCreative);let d=this.totalAds-this.nextAds.length,m=new L(d,!1,this.totalTimeAds,this.currentPodIndex,0,this.totalAds);c.debug(g,`current podInfo: [${d}] [${this.totalTimeAds}] [${this.totalAds}]`),this.currentAd=new T(this.currentAdVast,i,r,m),e||this.dispatchAdsEvent(h.Type.CONTENT_PAUSE_REQUESTED),this.playAdsContent(r.fileURL).catch(v=>{});return}}return this.playCreativities()}if(!this.nextAds||this.nextAds.length===0){this.allAdsCompleted();return}let t=this.nextAds.shift();return t?(this.currentAdVast=t,this.queueCreatives=this.getCreativities(t),this.playCreativities()):this.playCreativities()}handleContentTimeUpdate(){let e=this.content;if(!this.isValidContentObject(e)||this.cuePoints.length===0||this.processingAdv)return;if(this.nextAds&&this.nextAds.length>0){this.processingAdv=!0,this.playCreativities();return}let t=e.currentTime*1e3;c.debug(g,`Content current time: [${t}]`);let i=this.cuePoints.find(s=>Math.abs(s-t)<=K);i&&this.fetchVastAds(i)}clearTimerUpdateContentTime(){clearTimeout(this.timerUpdateContentTime)}startTimerUpdateContentTime(){this.clearTimerUpdateContentTime(),this.timerUpdateContentTime=setTimeout(()=>{this.handleContentTimeUpdate(),this.startTimerUpdateContentTime()},300)}attachContentMediaEventListeners(){let e=this.content;e&&(e instanceof HTMLVideoElement?e.addEventListener("timeupdate",this.handleContentTimeUpdate):"currentTime"in e&&this.startTimerUpdateContentTime())}detachContentMediaEventListeners(){let e=this.content;if(e)if(e instanceof HTMLVideoElement){let t=e}else"currentTime"in e}isValidAdBreak(e){let t=e["vmap:AdSource"];return!(!t||!t["vmap:AdTagURI"]?.["#text"]?.trim())}getAdValidCreative(e){let t=e.creatives;if(t&&t.length>0){for(let i of t)if(i.type==="linear"){let o=i.mediaFiles;if(o&&o.length>0)for(let d of o){let m=d.mimeType;if(m&&m.startsWith("video/mp4")&&d.fileURL)return i}}}}getCreativities(e){let t=[],i=e.creatives;if(i&&i.length>0){for(let s of i)if(s.type==="linear"){let d=s.mediaFiles;if(d&&d.length>0)for(let m of d){let v=m.mimeType;if(v&&v.startsWith("video/mp4")&&m.fileURL){t.push(s);break}}}}return t}trackingEvent(e){let t=this.currentCreative;if(!t)return;let s=t.trackingEvents?.[e];if(s)for(let r of s)this.trackUrl(r)}trackUrl(e){try{if(globalThis){let t=new globalThis.Image;t.src=e}}catch{}}getPromiseVastClient(e){return new W().get(e)}async fetchVastAds(e){if(this.started)try{this.currentPodIndex=e;let t=this.cueMapPoints[e];delete this.cueMapPoints[e];let i=[],s=0,r=0;if(t){let o=[];for(let m of t){let v=m["vmap:AdSource"];if(v){let A=v["vmap:AdTagURI"]?.["#text"]?.trim();A&&i.push(this.getPromiseVastClient(A))}}let d=await Promise.allSettled(i);for(let m of d)if(m.status==="fulfilled"){let v=m.value,A=v?.ads??void 0;if(A&&A.length>0)for(let b of A){let V=this.getAdValidCreative(b);V&&(o.push(b),s+=V.duration||0,r+=1)}else v.errorURLTemplates?.forEach(b=>{this.trackUrl(b)})}this.nextAds=o,this.totalAds=r,this.totalTimeAds=s,this.nextAds.length===0?this.allAdsCompleted():this.playCreativities()}}catch(t){c.error(g,"fetchVastAds error:",t)}}dispatchAdsEvent(e){c.debug(g,"dispatchAdsEvent: ",e),this.eventEmitter.emit(e,new h.AdEvent(e,this.currentAd))}adsVideoEventsListener(e){let t=this.adDisplayContainer.getVideoAdsElement();if(t)switch(e.type){case"canplay":{this.dispatchAdsEvent(h.Type.AD_CAN_PLAY);break}case"metadata":{this.dispatchAdsEvent(h.Type.AD_METADATA);break}case"play":{this.quartilesFired.start||(this.quartilesFired.start=!0,this.dispatchAdsEvent(h.Type.STARTED));break}case"pause":{this.dispatchAdsEvent(h.Type.PAUSED);break}case"timeupdate":{let i=t.duration||-1;if(!isNaN(i)&&i>=0){let s=t.currentTime||0,r=s/i,o=i-s,d=this.currentCreative?.skipDelay||0;this.adRemainingTime=o,this.adDuration=i,c.debug(g,`video adv currentTime: ${s}, Percentage: ${r}%, SkipDelay: ${d}`),this.quartilesFired.start||(this.quartilesFired.start=!0,this.dispatchAdsEvent(h.Type.STARTED)),!this.quartilesFired.firstQuartile&&r>=.25&&(this.quartilesFired.firstQuartile=!0,this.dispatchAdsEvent(h.Type.FIRST_QUARTILE)),!this.quartilesFired.midpoint&&r>=.5&&(this.quartilesFired.midpoint=!0,this.dispatchAdsEvent(h.Type.MIDPOINT)),!this.quartilesFired.thirdQuartile&&r>=.75&&(this.quartilesFired.thirdQuartile=!0,this.dispatchAdsEvent(h.Type.THIRD_QUARTILE)),this.vastTracker?.setProgress(s),!this.canBeAdSkippable&&d>0&&s>=d&&(this.canBeAdSkippable=!0,c.debug(g,`video adv can be skippable: [${s}] [${i}] [${d}]`),this.dispatchAdsEvent(h.Type.SKIPPABLE_STATE_CHANGED))}break}case"ended":{this.adRemainingTime=-1,this.adDuration=-1,this.quartilesFired.complete||(this.quartilesFired.complete=!0,this.dispatchAdsEvent(h.Type.COMPLETE)),this.vastTracker?.complete(),this.playCreativities();break}}}adsVideoErrorListener(e){this.adDisplayContainer?.hideAdVideoElement(),this.adDisplayContainer?.clearAdVideoElement(),this.playCreativities()}resetQuartilesFired(){this.quartilesFired={start:!1,firstQuartile:!1,midpoint:!1,thirdQuartile:!1,complete:!1}}async playAdsContent(e){let t=this.adDisplayContainer.getVideoAdsElement();if(!t)return c.error(g,"playAdsContent no Video Ads Element: "),this.playCreativities();this.adRemainingTime=-1,this.adDuration=-1,this.canBeAdSkippable=!1,this.resetQuartilesFired(),this.removeVideoListeners(),this.adDisplayContainer?.show(),this.adDisplayContainer?.showLoader(),this.adDisplayContainer?.hideAdVideoElement(),t.src=e,t.autoplay=!0;try{await O(t),await t.play(),this.addVideoListeners(),this.adDisplayContainer?.showAdVideoElement(),this.adDisplayContainer?.hideLoader(),this.dispatchAdsEvent(h.Type.AD_CAN_PLAY)}catch(i){c.error(g,"playAdsContent error: ",i),this.dispatchAdsEvent(h.Type.AD_BREAK_FETCH_ERROR),this.adDisplayContainer?.hideAdVideoElement(),this.playCreativities()}finally{this.adDisplayContainer.hideLoader()}}addVideoListeners(){let e=this.adDisplayContainer.getVideoAdsElement();e&&(x.forEach(t=>e.addEventListener(t,this.adsVideoEventsListener)),e.addEventListener("error",this.adsVideoErrorListener))}removeVideoListeners(){let e=this.adDisplayContainer.getVideoAdsElement();e&&(x.forEach(t=>e.removeEventListener(t,this.adsVideoEventsListener)),e.removeEventListener("error",this.adsVideoErrorListener))}};var _;(t=>{let a;(s=>s.ADS_MANAGER_LOADED="adsManagerLoaded")(a=t.Type||={});class e{currentTarget;target;type;adsManager;constructor(s){this.adsManager=s,this.currentTarget=null,this.target=null,this.type="adsManagerLoaded"}getAdsManager(s,r){return this.adsManager.configureAdsManager(s,r),this.adsManager}getUserRequestContext(){throw new Error("Method not implemented.")}preventDefault(){throw new Error("Method not implemented.")}stopPropagation(){throw new Error("Method not implemented.")}}t.AdsManagerLoadedEvent=e})(_||={});var Y="ima:AdsLoader",N=class{adDisplayContainer;adsManager=void 0;eventEmitter;userRequestContext=void 0;imaSdkSettings=new E.ImaSdkSettings;constructor(e){this.adDisplayContainer=e,this.eventEmitter=new f}addEventListener(e,t,i,s){this.eventEmitter.addEventListener(e,t,i,s)}contentComplete(){}dispatchEvent(e){return!0}getSettings(){return this.imaSdkSettings}getVersion(){return"custom"}removeEventListener(e,t,i,s){this.eventEmitter.removeEventListener(e,t,i)}requestAds(e,t){if(this.userRequestContext=t||void 0,!e.adTagUrl){let s=new S.AdError(google.ima.AdError.ErrorCode.FAILED_TO_REQUEST_ADS,"AdManager is already defined or adTagUrl is not defined");this.eventEmitter.emit(google.ima.AdErrorEvent.Type.AD_ERROR,new y.AdErrorEvent(s));return}this.adsManager=new R(e,this.adDisplayContainer),this.adsManager.fetchVmap().then(s=>(this.adsManager=s,this.eventEmitter.emit(google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,new _.AdsManagerLoadedEvent(s)))).catch(s=>{let r=s.message||"Unable to retrive vmap files",o=new S.AdError(google.ima.AdError.ErrorCode.FAILED_TO_REQUEST_ADS,s.message||"Unable to retrive vmap files");return c.error(Y,r,o),this.eventEmitter.emit(google.ima.AdErrorEvent.Type.AD_ERROR,new y.AdErrorEvent(o))})}destroy(){this.adsManager?.destroy(),this.adDisplayContainer.destroy(),this.eventEmitter.clearAllEventListeners()}};var U=class{autoAlign=!1;bitrate=-1;enablePreloading=!1;loadVideoTimeout=-1;mimeTypes=null;playAdsAfterTime=0;restoreCustomPlaybackStateOnAdBreakComplete=!1;uiElements=null;useStyledLinearAds=!0;useStyledNonLinearAds=!1};var w=class{adTagUrl;adsResponse;contentDuration;contentKeywords;contentTitle;forceNonLinearFullSlot;linearAdSlotHeight;linearAdSlotWidth;liveStreamPrefetchSeconds;nonLinearAdSlotHeight;nonLinearAdSlotWidth;omidAccessModeRules;pageUrl;vastLoadTimeout;constructor(){this.adTagUrl="",this.adsResponse=null,this.contentDuration=null,this.contentKeywords=null,this.contentTitle=null,this.forceNonLinearFullSlot=!1,this.linearAdSlotHeight=0,this.linearAdSlotWidth=0,this.liveStreamPrefetchSeconds=0,this.nonLinearAdSlotHeight=0,this.nonLinearAdSlotWidth=0,this.omidAccessModeRules={},this.pageUrl=null,this.vastLoadTimeout=0}setAdWillAutoPlay(e){}setAdWillPlayMuted(e){}setContinuousPlayback(e){}};function At(a,e="debug"){c.setEnable(a),c.setLogLevel(e)}var $=(t=>(t.FULLSCREEN="fullscreen",t.NORMAL="normal",t))($||{});String.prototype.trimStart||(String.prototype.trimStart=String.prototype.trimLeft);typeof String.prototype.endsWith!="function"&&(String.prototype.endsWith=function(a){return this.indexOf(a,this.length-a.length)!==-1});var Kt=C;export{T as Ad,k as AdDisplayContainer,S as AdError,y as AdErrorEvent,h as AdEvent,L as AdPodInfo,N as AdsLoader,R as AdsManager,_ as AdsManagerLoadedEvent,U as AdsRenderingSettings,w as AdsRequest,E as ImaSdkSettings,Kt as VERSION,$ as ViewMode,At as activateDebug,B as settings};
/* Built on 2025-04-30T09:45:31.526Z */
